# 23 Билет
## Теория

**Функции для работы с файлами в UNIX-подобных операционных системах.**

Функции:

1. open() — Открытие файла

Описание: Функция открывает файл, указанный в pathname, и возвращает дескриптор файла (fd).Если файл не существует, можно задать флаг O_CREAT, чтобы создать его.

Аргументы: 

pathname: путь к файлу. 

flags: режим открытия (например, O_RDONLY, O_WRONLY, O_RDWR, O_APPEND, O_TRUNC). 

mode: права доступа (используется, если файл создаётся, например, 0644).

Возвращаемое значение: Положительный дескриптор файла (fd) при удачном открытии или отрицательное значение (-1) в случае ошибки.

2. read() — Чтение данных из файлаwrite

Описание: Читает данные из файла, указанного дескриптором fd, в буфер buf.

Аргументы: 

fd: дескриптор файла. 

buf: буфер, куда будут записаны считанные данные. 

count: максимальное количество байт, которые нужно прочитать.

Возвращаемое значение: Количество реально прочитанных байт или -1 в случае ошибки.

3. write() — Запись данных в файл Пример: int fd = open("a.txt", O_RDONLY);

Описание: Записывает данные из буфера buf в файл, указанный дескриптором fd.

Аргументы: 

fd: дескриптор файла. 

buf: буфер с данными для записи. 

count: количество байт, которые нужно записать.

Возвращаемое значение: Количество реально записанных байт или -1 в случае ошибки.

4. close() — Закрытие файла

Описание: Закрывает файл, указанный дескриптором fd.

Аргументы: 

fd: дескриптор файла.

Возвращаемое значение:0 при успешном закрытии или -1 в случае ошибки.

## Практика 

Программа с импортом функции из файла DLL. Функция принимает  структуру, содержащую координаты двух точек, а возвращает длину отрезка, который образуется этими точками 

```C
#include <windows.h>
#include <stdio.h>
#define PATH L"ddlLibrary.dll"

typedef struct {
	float x1;
	float y1;
	float x2;
	float y2;
} Points;

typedef float(*GetWidth)(Points*);

int main()
{
	HANDLE dll = LoadLibrary(PATH); //Подключение dll
	Points points = { 1, 2, 2, 2 };
	GetWidth CountWidth = GetProcAddress(dll, "CountWidth");
	printf("%f", CountWidth(&points));
	FreeLibrary(dll); //отключение DLL
}
```

``` C
#include <windows.h>
#include <math.h>

BOOL WINAPI DllMain()
{
	return TRUE;
}

typedef struct {
	float x1;
	float y1;
	float x2;
	float y2;
} Points;

//declare specifier - объявить спецификатор
__declspec(dllimport) float CountWidth(Points* p);
float CountWidth(Points* p)
{
	float result = sqrt(pow(p->x1 - p->x2, 2) + pow(p->y1 - p->y2, 2));
	return result;
}
```