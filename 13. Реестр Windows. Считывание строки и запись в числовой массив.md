# 13 Билет

## Теория 

**Назначение реестра Windows. Особенности использования системного реестра программами. Структура системного реестра. Типы данных в системном реестре.**

Реестр Windows — это централизованная база данных, в которой хранятся  параметры конфигурации операционной системы, установленные программы, оборудование и профили пользователей. Фактически реестр служит местом хранения почти всех настроек и сведений, влияющих на работу Windows и установленных приложений.

Цель реестра — позволить программам и самой системе сохранять, получать и изменять настройки, конфигурировать оборудование и управлять поведением системы.

Структура:

Основными узлами реестра называются корневыми ключами. Среди них выделяются пять основных корневых ключей:

1. HKEY_CLASSES_ROOT (HKCR)Хранит ассоциации между расширениями файлов и программами, которые их открывают. Сюда заносятся пути к программам, зарегистрированным типам файлов и прочим данным, связанным с ассоциациями.

2. HKEY_CURRENT_USER (HKCU)Содержит персональные настройки текущего пользователя, такие как предпочтения рабочего стола, папки и личные настройки программ.

3. HKEY_LOCAL_MACHINE (HKLM)Основной ключ, содержащий системные настройки, информацию о зарегистрированных устройствах, драйверах и общих параметрах системы. Настройки HKLM относятся ко всему компьютеру, а не отдельному пользователю.

4. HKEY_USERS (HKU)Сохраняет настройки всех пользователей, зарегистрированных на компьютере. Каждая учетная запись пользователя соответствует своему подразделу в HKU.

5. HKEY_CURRENT_CONFIG (HKCC)Включает информацию о текущих аппаратных профилях и конфигурации оборудования, используемой системой.

Типы данных:
1. REG_SZ (String Value)Обычная строка Unicode, такая как путь к файлу или название программы.
2. REG_BINARY (Binary Data)Данные произвольного формата, представленные в двоичном виде. Например, зашифрованные ключи или иконки.
3. REG_DWORD (DWORD Value)Целое число размером 32 бита, используемое для простых настроек (включено/выключено, уровни громкости и т.д.).
4. REG_QWORD (QWORD Value)Целое число размером 64 бита, используется для хранения больших чисел или временных отметок.
5. REG_MULTI_SZ (Multi-String Value)Список строк, разделенных пробелами или табуляторами. Например, список путей поиска для среды PATH.

Особенности использования системного реестра программами:

Программы могут обращаться к реестру для:
1. Сохранения настроек: Информация о расположении файлов, путях, предпочтениях пользователя.
2. Регистрации программ: Регистрация программ в списке автозапуска, регистрация типов файлов и команд меню.
3. Получения системной информации: Получение сведений о драйверах, оборудовании, статусе системы.

## Практика
Программа для считывания нескольких числовых значений из строки и их записи в числовой массив (разделитель - пробел). Количество значений в строке заранее неизвестно. (отдельно для Windows и Linux)

Шаг 1. Для Windows создать main.c файл

``` C
#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <malloc.h>

int main() {
	system("chcp 1251");

	char* str = calloc(100, 1);

	gets(str);

	printf("считанная строка: %s\n", str);
	
	float* numbers = calloc(0, sizeof(float));
	
	char* strArray = strtok(str, " ");
	int size = 0;
	while (strArray != 0) {
		printf("текущий указатель %s\n", strArray);
		size++;
		numbers = realloc(numbers, sizeof(float) * size);
		numbers[size - 1] = atof(strArray);
		strArray = strtok(0, " ");
	}

	for (int i = 0; i < size; i++) {
		printf("%f\n", numbers[i]);
	}
}
```

Шаг 2. Для Linux создать main.c файл с следующим кодом 

``` C
#define _GNU_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <malloc.h>

int main() {
	char* buffer = calloc(100, 1);
	gets(buffer);
	printf("Мы считали это: %s\n", buffer);
	float* doubles = calloc(0, sizeof(float));
	char* firstNum = strtok(buffer, " ");
	int size = 0;
	while(firstNum != 0) {
		printf("Текущий указатель: %s\n", firstNum);
		size++;
		doubles = realloc(doubles, sizeof(float) * size);
		doubles[size - 1] = atof(firstNum);
		firstNum = strtok(0, " "); 
	}
	for (size_t i = 0; i < size; i++)
	{
		printf("%ld число: %f\n", i + 1, doubles[i]);
	}
	
}
```

Шаг 3. Необходимо компилировать файл с флагом -lm.

``` 
gcc main.c -lm 
./a.out
```
